# –°–≤–æ–¥–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ Backend

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### 1. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ –ú–∏–Ω–∏–º—É–º –∑–∞ 3 —á–∞—Å–∞ –¥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ `BookingCreate` schema —á–µ—Ä–µ–∑ `model_validator`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤
- ‚úÖ –ú–æ–¥–µ–ª—å `Review` –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—É–±–ª–∏—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
- ‚úÖ –ú–æ–¥–µ—Ä–∞—Ü–∏—è –æ—Ç–∑—ã–≤–æ–≤ (is_approved)
- ‚úÖ CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–∞:
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤
  - –û–¥–æ–±—Ä–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤
  - –£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∑—ã–≤–æ–≤

### 3. –ü–æ–ª–Ω—ã–π CRUD –¥–ª—è –º–µ–Ω—é
- ‚úÖ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–µ–Ω—é:
  - –°–æ–∑–¥–∞–Ω–∏–µ
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - –£–¥–∞–ª–µ–Ω–∏–µ
- ‚úÖ –ü–æ–∑–∏—Ü–∏–∏ –º–µ–Ω—é:
  - –°–æ–∑–¥–∞–Ω–∏–µ
  - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ
  - –£–¥–∞–ª–µ–Ω–∏–µ

### 4. –ü–æ–ª–Ω—ã–π CRUD –¥–ª—è —Å—Ç–æ–ª–æ–≤
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–æ–ª–æ–≤ —Å –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç–∞–º–∏ (x, y, rotation)
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–æ–≤ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –Ω–∞ –∫–∞—Ä—Ç–µ)
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–æ–≤
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–ø–∏—Å–∫—É —Å—Ç–æ–ª–æ–≤

## üìã API Endpoints

### –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
```
POST /api/bookings
  - –í–∞–ª–∏–¥–∞—Ü–∏—è: –º–∏–Ω–∏–º—É–º –∑–∞ 3 —á–∞—Å–∞
  - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä —Å—Ç–æ–ª–∞
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏

GET /api/bookings/availability
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–Ω—è—Ç—ã—Ö/—Å–≤–æ–±–æ–¥–Ω—ã—Ö —Å—Ç–æ–ª–æ–≤

POST /api/bookings/{id}/webhook
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
```

### –û—Ç–∑—ã–≤—ã
```
GET /api/reviews
  - –ü–æ–ª—É—á–∏—Ç—å –æ–¥–æ–±—Ä–µ–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã (–ø—É–±–ª–∏—á–Ω—ã–π)

POST /api/reviews
  - –°–æ–∑–¥–∞—Ç—å –æ—Ç–∑—ã–≤ (–ø—É–±–ª–∏—á–Ω—ã–π, —Ç—Ä–µ–±—É–µ—Ç –º–æ–¥–µ—Ä–∞—Ü–∏–∏)

GET /api/reviews/pending
  - –ù–µ–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –æ—Ç–∑—ã–≤—ã (Admin)

PUT /api/reviews/{id}/approve
  - –û–¥–æ–±—Ä–∏—Ç—å –æ—Ç–∑—ã–≤ (Admin)

DELETE /api/reviews/{id}
  - –£–¥–∞–ª–∏—Ç—å –æ—Ç–∑—ã–≤ (Admin)
```

### –ú–µ–Ω—é
```
GET /api/menu
  - –ü–æ–ª—É—á–∏—Ç—å –º–µ–Ω—é (–ø—É–±–ª–∏—á–Ω—ã–π)

POST /api/menu/categories
  - –°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é (Admin)

PUT /api/menu/categories/{id}
  - –û–±–Ω–æ–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é (Admin)

DELETE /api/menu/categories/{id}
  - –£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é (Admin)

POST /api/menu/items
  - –°–æ–∑–¥–∞—Ç—å –ø–æ–∑–∏—Ü–∏—é (Admin)

PUT /api/menu/items/{id}
  - –û–±–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é (Admin)

DELETE /api/menu/items/{id}
  - –£–¥–∞–ª–∏—Ç—å –ø–æ–∑–∏—Ü–∏—é (Admin)
```

### –°—Ç–æ–ª—ã
```
GET /api/tables
  - –ü–æ–ª—É—á–∏—Ç—å —Å—Ç–æ–ª—ã (–ø—É–±–ª–∏—á–Ω—ã–π, –¥–ª—è –∫–∞—Ä—Ç—ã –∑–∞–ª–∞)

POST /api/tables
  - –°–æ–∑–¥–∞—Ç—å —Å—Ç–æ–ª (Admin)

PUT /api/tables/{id}
  - –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–æ–ª (Admin, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç)

DELETE /api/tables/{id}
  - –£–¥–∞–ª–∏—Ç—å —Å—Ç–æ–ª (Admin)
```

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ –∞–¥–º–∏–Ω-–æ–ø–µ—Ä–∞—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã JWT —Ç–æ–∫–µ–Ω–æ–º
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Pydantic
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ `get_current_admin_user`

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (–≤–∞–ª–∏–¥–∞—Ü–∏—è 3 —á–∞—Å–∞)
```bash
POST /api/bookings
{
  "user_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
  "user_phone": "+79161234567",
  "date": "2024-12-25",
  "time": "19:00",  # –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –º–∏–Ω–∏–º—É–º —á–µ—Ä–µ–∑ 3 —á–∞—Å–∞
  "guest_count": 4,
  "table_id": 201
}
```

–ï—Å–ª–∏ –≤—Ä–µ–º—è –º–µ–Ω—å—à–µ —á–µ–º —á–µ—Ä–µ–∑ 3 —á–∞—Å–∞:
```json
{
  "detail": [
    {
      "type": "value_error",
      "msg": "–ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Å–¥–µ–ª–∞–Ω–æ –º–∏–Ω–∏–º—É–º –∑–∞ 3 —á–∞—Å–∞ –¥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏"
    }
  ]
}
```

### –°–æ–∑–¥–∞–Ω–∏–µ –æ—Ç–∑—ã–≤–∞
```bash
POST /api/reviews
{
  "author": "–ï–ª–µ–Ω–∞ –°.",
  "rating": 5,
  "text": "–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω! –í–∫—É—Å–Ω–∞—è –µ–¥–∞ –∏ –ø—Ä–∏—è—Ç–Ω–∞—è –∞—Ç–º–æ—Å—Ñ–µ—Ä–∞.",
  "image_url": "https://example.com/photo.jpg"
}
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã —Å—Ç–æ–ª–æ–≤ (–∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏)
```bash
PUT /api/tables/201
Authorization: Bearer <admin_token>
{
  "zone": "HALL_2",
  "seats": 4,
  "x": 650,  # –ù–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è X
  "y": 250,  # –ù–æ–≤–∞—è –ø–æ–∑–∏—Ü–∏—è Y
  "rotation": 45,  # –ü–æ–≤–æ—Ä–æ—Ç —Å—Ç–æ–ª–∞
  "is_active": true
}
```

## üéØ –ê–ª–≥–æ—Ä–∏—Ç–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏**:
   - –î–∞—Ç–∞ –Ω–µ –≤ –ø—Ä–æ—à–ª–æ–º
   - –ú–∏–Ω–∏–º—É–º –∑–∞ 3 —á–∞—Å–∞ –¥–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
   - –í–∞–ª–∏–¥–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏**:
   - –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª–∏—Ç—Å—è 2 —á–∞—Å–∞
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
   - –£—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ CONFIRMED –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

3. **–°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è**:
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä —Å—Ç–æ–ª–∞ (–µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω)
   - –†–∞—Å—á–µ—Ç –¥–µ–ø–æ–∑–∏—Ç–∞ (500‚ÇΩ –∑–∞ –≥–æ—Å—Ç—è, –º–∏–Ω–∏–º—É–º 1000‚ÇΩ)
   - –°—Ç–∞—Ç—É—Å PENDING –¥–æ –æ–ø–ª–∞—Ç—ã

4. **–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**:
   - Webhook –æ—Ç –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã
   - –°—Ç–∞—Ç—É—Å –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ CONFIRMED
   - –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ Telegram

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é:
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (3 —á–∞—Å–∞)
- ‚úÖ –°–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å –º–æ–¥–µ—Ä–∞—Ü–∏–µ–π
- ‚úÖ –ü–æ–ª–Ω—ã–π CRUD –¥–ª—è –º–µ–Ω—é
- ‚úÖ –ü–æ–ª–Ω—ã–π CRUD –¥–ª—è —Å—Ç–æ–ª–æ–≤
- ‚úÖ –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ö–µ–º—ã –∑–∞–ª–æ–≤

